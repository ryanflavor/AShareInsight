# **8. 测试策略 (Testing Strategy)**

## **TDD 核心原则**
  * **红-绿-重构循环**: 先写失败测试 → 写最少代码使测试通过 → 重构优化
  * **测试先行**: 核心业务逻辑必须先写测试，再写实现
  * **单一职责**: 每个测试只验证一个具体行为
  * **快速反馈**: 单元测试执行时间 < 50ms，集成测试 < 5s

## **测试分层架构**
  * **测试金字塔**: 以大量的**单元测试**为基础，辅以适量的**集成测试**和少量的**端到端测试**。
  * **单元测试**: 使用 `pytest` 和 `pytest-mock`，在隔离环境中测试单个函数/类，必须模拟所有外部依赖。
  * **集成测试**: 连接到运行在Docker中的真实PostgreSQL数据库，测试模块间的内部协作。
  * **端到端测试**: 使用`httpx`库，向部署在预发布环境上的完整应用发送真实API请求，并验证响应是否符合预期，数据源为一套可控的真实初始化数据。

## **向量数据库测试标准**
  * **性能基准**: HNSW搜索延迟 < 10ms (100万向量)
  * **精度验证**: 向量相似度搜索准确率 > 95%
  * **兼容性测试**: 验证 langchain-postgres + pgvector 版本矩阵

-----
